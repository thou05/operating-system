Created: 202412282347
Tags: 

### 1. **Khái niệm bế tắc (Deadlock)**

- **Định nghĩa**: Bế tắc xảy ra khi một tập hợp tiến trình bị chặn, mỗi tiến trình giữ ít nhất một tài nguyên và chờ tài nguyên khác đang bị giữ bởi tiến trình khác trong tập hợp.
- **Ví dụ**:
    - Hệ thống có 2 băng từ, tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math>P1​ và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math>P2​ mỗi tiến trình giữ một băng từ và yêu cầu băng từ còn lại.
    - Với semaphore <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math>A và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math>B (khởi tạo bằng 1), hai tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math>P0​ và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math>P1​ thực hiện lệnh wait(A); wait(B); và wait(B); wait(A); đồng thời, dẫn đến bế tắc.

### 2. **Đặc điểm của bế tắc**

Bế tắc xảy ra khi 4 điều kiện sau đồng thời thỏa mãn:

1. **Độc quyền truy xuất (Mutual Exclusion)**: Chỉ một tiến trình được sử dụng tài nguyên tại một thời điểm.
2. **Giữ và chờ (Hold and Wait)**: Tiến trình giữ ít nhất một tài nguyên và chờ tài nguyên khác đang bị giữ bởi tiến trình khác.
3. **Không chiếm đoạt (No Preemption)**: Tài nguyên chỉ được giải phóng tự nguyện bởi tiến trình giữ nó sau khi hoàn thành.
4. **Chờ đợi vòng tròn (Circular Wait)**: Một tập tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>P</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>P</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{P_0, P_1, \ldots, P_n\}</annotation></semantics></math>{P0​,P1​,…,Pn​} tạo thành vòng, trong đó <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math>P0​ chờ tài nguyên của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math>P1​, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math>P1​ chờ tài nguyên của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math>P2​, ..., và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">P_n</annotation></semantics></math>Pn​ chờ tài nguyên của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math>P0​.

### 3. **Mô hình hệ thống**

- **Tài nguyên**: Có các loại <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>R</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">R_1, R_2, \ldots, R_m</annotation></semantics></math>R1​,R2​,…,Rm​ (ví dụ: CPU, bộ nhớ, thiết bị I/O). Mỗi tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R_i</annotation></semantics></math>Ri​ có <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math>Wi​ thể hiện.
- **Quy trình sử dụng tài nguyên**:
    1. Yêu cầu (request).
    2. Sử dụng (use).
    3. Giải phóng (release).

### 4. **Đồ thị phân phối tài nguyên (Resource Allocation Graph)**

- **Cấu trúc**:
    - Đỉnh: Tập tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>P</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">P = \{P_1, P_2, \ldots, P_n\}</annotation></semantics></math>P={P1​,P2​,…,Pn​} và tập tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>R</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>R</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R = \{R_1, R_2, \ldots, R_m\}</annotation></semantics></math>R={R1​,R2​,…,Rm​}.
    - Cạnh:
        - **Cạnh yêu cầu**: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>→</mo><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_i \rightarrow R_j</annotation></semantics></math>Pi​→Rj​ (tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ yêu cầu tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R_j</annotation></semantics></math>Rj​).
        - **Cạnh phân phối**: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub><mo>→</mo><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R_j \rightarrow P_i</annotation></semantics></math>Rj​→Pi​ (tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R_j</annotation></semantics></math>Rj​ được phân phối cho tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​).
- **Định lý**:
    - Nếu đồ thị không có chu trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math>⇒ không có bế tắc.
    - Nếu đồ thị có chu trình:
        - Tài nguyên chỉ có một thể hiện <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math>⇒ bế tắc.
        - Tài nguyên có nhiều thể hiện <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math>⇒ có thể xảy ra bế tắc.

### 5. **Các phương pháp xử lý bế tắc**

1. **Ngăn chặn bế tắc**: Đảm bảo hệ thống không bao giờ rơi vào trạng thái bế tắc.
2. **Tránh bế tắc**: Cho phép hệ thống vào trạng thái bế tắc nhưng sử dụng thuật toán để tránh.
3. **Phát hiện và khôi phục**: Cho phép bế tắc xảy ra, sau đó phát hiện và khôi phục.
4. **Bỏ qua**: Giả định bế tắc không xảy ra (phổ biến trong các hệ điều hành như UNIX).

### 6. **Ngăn chặn bế tắc**

Ngăn chặn bằng cách phá vỡ một trong 4 điều kiện bế tắc:

- **Độc quyền truy xuất**: Không áp dụng cho tài nguyên không chia sẻ được (như máy in).
- **Giữ và chờ**:
    - Tiến trình phải yêu cầu tất cả tài nguyên trước khi thực thi.
    - Tiến trình chỉ được yêu cầu tài nguyên khi không giữ tài nguyên nào (dẫn đến hiệu suất thấp, có thể gây chết đói).
- **Không chiếm đoạt**:
    - Nếu tiến trình yêu cầu tài nguyên không được cấp ngay, tài nguyên đang giữ sẽ bị giải phóng và tiến trình chờ.
- **Chờ đợi vòng tròn**:
    - Áp đặt thứ tự toàn cục cho tài nguyên, yêu cầu tiến trình yêu cầu tài nguyên theo thứ tự tăng dần.

### 7. **Tránh bế tắc**

- **Yêu cầu thông tin trước**: Mỗi tiến trình khai báo số tài nguyên tối đa cần thiết.
- **Trạng thái an toàn (Safe State)**:
    - Hệ thống an toàn nếu tồn tại chuỗi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>P</mi><mi>n</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle P_1, P_2, \ldots, P_n \rangle</annotation></semantics></math>⟨P1​,P2​,…,Pn​⟩, trong đó tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ cần có thể được cấp từ tài nguyên rỗi hoặc tài nguyên của các tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_j</annotation></semantics></math>Pj​ (với <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>&#x3C;</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j &#x3C; i</annotation></semantics></math>j<i).
    - Nếu không an toàn, có thể xảy ra bế tắc.
- **Thuật toán Banker**:
    - Mỗi tiến trình khai báo số tài nguyên tối đa cần.
    - Khi tiến trình yêu cầu tài nguyên, hệ thống kiểm tra xem việc phân phối có giữ trạng thái an toàn hay không.
    - Nếu không an toàn, tiến trình phải chờ.

#### **Cấu trúc dữ liệu của thuật toán Banker**:

- <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math>n: số tiến trình, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math>m: số loại tài nguyên.
- **Available**: Vector độ dài <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math>m, chỉ số thể hiện tài nguyên rỗi.
- **Max**: Ma trận <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>n×m, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">Max[i,j] = k</annotation></semantics></math>Max[i,j]=k nghĩa là <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ yêu cầu tối đa <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math>k thể hiện của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R_j</annotation></semantics></math>Rj​.
- **Allocation**: Ma trận <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>n×m, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">Allocation[i,j] = k</annotation></semantics></math>Allocation[i,j]=k nghĩa là <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ đang được phân phối <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math>k thể hiện của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">R_j</annotation></semantics></math>Rj​.
- **Need**: Ma trận <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>n×m, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>e</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Need[i,j] = Max[i,j] - Allocation[i,j]</annotation></semantics></math>Need[i,j]=Max[i,j]−Allocation[i,j], chỉ số thể hiện còn thiếu của <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​.

#### **Thuật toán Safety**:

1. Khởi tạo: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>=</mo><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Work = Available</annotation></semantics></math>Work=Available, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = false</annotation></semantics></math>Finish[i]=false cho mọi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math>i.
2. Tìm <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math>i sao cho <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = false</annotation></semantics></math>Finish[i]=false và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>i</mi></msub><mo>≤</mo><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">Need_i \leq Work</annotation></semantics></math>Needi​≤Work. Nếu không tìm được, nhảy bước 4.
3. Cập nhật: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>=</mo><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>+</mo><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Work = Work + Allocation_i</annotation></semantics></math>Work=Work+Allocationi​, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = true</annotation></semantics></math>Finish[i]=true, quay lại bước 2.
4. Nếu <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = true</annotation></semantics></math>Finish[i]=true cho mọi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math>i, hệ thống an toàn.

#### **Thuật toán phân phối tài nguyên**:

1. Kiểm tra <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>i</mi></msub><mo>≤</mo><mi>N</mi><mi>e</mi><mi>e</mi><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Request_i \leq Need_i</annotation></semantics></math>Requesti​≤Needi​, nếu sai thì báo lỗi.
2. Kiểm tra <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>i</mi></msub><mo>≤</mo><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Request_i \leq Available</annotation></semantics></math>Requesti​≤Available, nếu sai thì <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ phải chờ.
3. Thử phân phối: Cập nhật <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Available</annotation></semantics></math>Available, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Allocation</annotation></semantics></math>Allocation, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Need</annotation></semantics></math>Need, rồi kiểm tra trạng thái an toàn.
    - Nếu an toàn, phân phối tài nguyên.
    - Nếu không an toàn, khôi phục trạng thái và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ phải chờ.

#### **Ví dụ thuật toán Banker**:

- 5 tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math>P0​ đến <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math>P4​, 3 loại tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A(10)</annotation></semantics></math>A(10), <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B(5)</annotation></semantics></math>B(5), <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C(7)</annotation></semantics></math>C(7).
- Trạng thái ban đầu:
    - <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Available = (3, 3, 2)</annotation></semantics></math>Available=(3,3,2).
    - Ma trận <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Allocation</annotation></semantics></math>Allocation, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">Max</annotation></semantics></math>Max, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Need</annotation></semantics></math>Need.
- Chuỗi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>0</mn></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle P_1, P_3, P_4, P_2, P_0 \rangle</annotation></semantics></math>⟨P1​,P3​,P4​,P2​,P0​⟩ thỏa mãn trạng thái an toàn.
- Khi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math>P1​ yêu cầu <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 0, 2)</annotation></semantics></math>(1,0,2), kiểm tra và phân phối thành công.

### 8. **Phát hiện bế tắc**

- **Đồ thị Wait-for** (mỗi tài nguyên có một thể hiện):
    - Nút: Tiến trình.
    - Cạnh: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>→</mo><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_i \rightarrow P_j</annotation></semantics></math>Pi​→Pj​ nếu <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ chờ <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_j</annotation></semantics></math>Pj​.
    - Kiểm tra chu trình: Độ phức tạp <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math>O(n2), <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math>n là số tiến trình.
- **Thuật toán phát hiện (nhiều thể hiện tài nguyên)**:
    - **Dữ liệu**: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Available</annotation></semantics></math>Available, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Allocation</annotation></semantics></math>Allocation, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Request</annotation></semantics></math>Request.
    - **Bước**:
        1. Khởi tạo <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>=</mo><mi>A</mi><mi>v</mi><mi>a</mi><mi>i</mi><mi>l</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Work = Available</annotation></semantics></math>Work=Available, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = false</annotation></semantics></math>Finish[i]=false nếu <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Allocation_i \neq 0</annotation></semantics></math>Allocationi​=0, ngược lại <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = true</annotation></semantics></math>Finish[i]=true.
        2. Tìm <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math>i sao cho <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = false</annotation></semantics></math>Finish[i]=false và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>q</mi><mi>u</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>i</mi></msub><mo>≤</mo><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">Request_i \leq Work</annotation></semantics></math>Requesti​≤Work.
        3. Cập nhật <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>=</mo><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mo>+</mo><mi>A</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Work = Work + Allocation_i</annotation></semantics></math>Work=Work+Allocationi​, <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = true</annotation></semantics></math>Finish[i]=true, quay lại bước 2.
        4. Nếu tồn tại <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math>i mà <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Finish[i] = false</annotation></semantics></math>Finish[i]=false, hệ thống bế tắc, và <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math>Pi​ bị bế tắc.
    - Độ phức tạp: <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \times n^2)</annotation></semantics></math>O(m×n2).

#### **Ví dụ phát hiện bế tắc**:

- 5 tiến trình, 3 loại tài nguyên <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A(7)</annotation></semantics></math>A(7), <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B(2)</annotation></semantics></math>B(2), <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C(6)</annotation></semantics></math>C(6).
- Trạng thái ban đầu: Chuỗi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>P</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle P_0, P_2, P_3, P_1, P_4 \rangle</annotation></semantics></math>⟨P0​,P2​,P3​,P1​,P4​⟩ cho thấy không bế tắc.
- Khi <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math>P2​ yêu cầu thêm 1 thể hiện <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math>C, hệ thống rơi vào bế tắc với các tiến trình <math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_1, P_2, P_3, P_4</annotation></semantics></math>P1​,P2​,P3​,P4​.

### 9. **Khôi phục sau bế tắc**

- **Kết thúc tiến trình**:
    - Dừng toàn bộ tiến trình bế tắc.
    - Dừng từng tiến trình cho đến khi phá vỡ chu trình bế tắc.
    - Tiêu chí lựa chọn: Ưu tiên, thời gian thực thi, tài nguyên đang sử dụng, v.v.
- **Chiếm đoạt tài nguyên**:
    - Chọn nạn nhân, quay lại trạng thái an toàn (rollback).
    - Nguy cơ chết đói nếu một tiến trình luôn bị chọn làm nạn nhân.

## Vấn đề bế tắc
Một tập các tiến trình bị chặn, mỗi tiến trình giữ 1 tài nguyên và chờ 1 tài nguyên bị chiếm giữ bởi 1 tiến trình khác trong tập

## Mô hình hệ thống

## Các đặc điểm của bế tắc

## Các phương pháp xử lý bế tắc

## Ngăn chặn bế tắc

## Tránh bế tắc

## Khôi phục sau bế tắc


-----
## References
1.
